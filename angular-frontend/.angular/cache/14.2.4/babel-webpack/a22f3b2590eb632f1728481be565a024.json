{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/mouji/IdeaProjects/Fitness-store-2022/angular-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ProductInfo } from \"../../../../common/shopping/product-info\";\nimport { CartItem } from \"../../../../common/shopping/cart-item\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../../services/product.service\";\nimport * as i3 from \"../../../../services/prod-details/stock.service\";\nimport * as i4 from \"../../../../services/shopping/cart/cart.service\";\nimport * as i5 from \"../../../../services/authentication/token-storage.service\";\nimport * as i6 from \"../../../../services/shopping/cart/guest-cart.service\";\nimport * as i7 from \"@angular/common\";\n\nfunction ProductPageComponent_button_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function ProductPageComponent_button_18_Template_button_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const size_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.selectSize(size_r1));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const size_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(size_r1.size);\n  }\n}\n\nexport class ProductPageComponent {\n  constructor(route, productService, stockService, cartService, tokenStorageService, guestCartService) {\n    this.route = route;\n    this.productService = productService;\n    this.stockService = stockService;\n    this.cartService = cartService;\n    this.tokenStorageService = tokenStorageService;\n    this.guestCartService = guestCartService;\n    this.productInfo = new ProductInfo();\n    this.currentProductId = 0;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.cartItem = new CartItem();\n      _this.cartItem.quantity = 1; // use Promise.all() to wait for both getProductById() and getAStock() to complete\n\n      yield Promise.all([_this.getProductById(), _this.getAStock()]);\n    })();\n  }\n\n  getAStock() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      // wait for getProductById() to complete before accessing its data\n      yield _this2.getProductById();\n\n      if (_this2.productInfo !== null) {\n        _this2.stockService.findStockByProduct(_this2.productInfo.productId).subscribe(data => {\n          _this2.stocks = data;\n        });\n      }\n    })();\n  }\n\n  getProductById() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      _this3.currentProductId = +_this3.route.snapshot.paramMap.get('prodId'); // set the productInfo value and wait for it to complete\n\n      yield _this3.productService.getProductById(_this3.currentProductId).toPromise().then(data => {\n        if (data != undefined) _this3.productInfo = data;\n      });\n    })();\n  }\n\n  addToCart() {\n    let user = this.tokenStorageService.getUser(); //TODO: Use this service in ProductPageComponent and CartPageComponent\n    //TODO: Check if enough in stock\n\n    this.cartItem.productInfo = this.productInfo;\n\n    if (this.tokenStorageService.getUser() == undefined) {\n      console.log('we in here biatch');\n      this.addToCartTwo(this.cartItem);\n    } else {\n      this.cartService.addToCart(this.cartItem).subscribe();\n    }\n  }\n\n  addToCartTwo(cartItem) {\n    const existingCartItem = this.guestCartService.cartItems.find(item => item.productInfo.productId === cartItem.productInfo.productId && item.relatedSizeAndStock.stockId === cartItem.relatedSizeAndStock.stockId);\n\n    if (existingCartItem) {\n      existingCartItem.quantity += cartItem.quantity;\n    } else {\n      this.guestCartService.cartItems.push(cartItem);\n    }\n  }\n\n  selectSize(size) {\n    this.cartItem.relatedSizeAndStock = size;\n  }\n\n  changeQty(value) {\n    this.cartItem.quantity += value;\n  }\n\n}\n\nProductPageComponent.ɵfac = function ProductPageComponent_Factory(t) {\n  return new (t || ProductPageComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ProductService), i0.ɵɵdirectiveInject(i3.StockService), i0.ɵɵdirectiveInject(i4.CartService), i0.ɵɵdirectiveInject(i5.TokenStorageService), i0.ɵɵdirectiveInject(i6.GuestCartService));\n};\n\nProductPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ProductPageComponent,\n  selectors: [[\"app-product-page\"]],\n  decls: 26,\n  vars: 4,\n  consts: [[1, \"product-page\"], [1, \"details-container\"], [1, \"product-name\"], [1, \"product-price\"], [1, \"horizontal-line\"], [1, \"product-size\"], [1, \"product-buttons\"], [1, \"quantity-buttons\"], [1, \"round-button\", 3, \"click\"], [1, \"size-buttons\"], [\"class\", \"product-btn\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"add-to-cart-btn\", 3, \"click\"], [1, \"product-description\"], [1, \"image-container\"], [1, \"product-image\", 3, \"src\"], [1, \"product-btn\", 3, \"click\"]],\n  template: function ProductPageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h1\", 2);\n      i0.ɵɵtext(3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"p\", 3);\n      i0.ɵɵtext(5, \" 200 \\u20AC \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(6, \"hr\", 4);\n      i0.ɵɵelementStart(7, \"p\", 5);\n      i0.ɵɵtext(8, \"size\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"div\", 6)(10, \"div\", 7)(11, \"button\", 8);\n      i0.ɵɵlistener(\"click\", function ProductPageComponent_Template_button_click_11_listener() {\n        return ctx.changeQty(-1);\n      });\n      i0.ɵɵtext(12, \"-\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"p\");\n      i0.ɵɵtext(14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"button\", 8);\n      i0.ɵɵlistener(\"click\", function ProductPageComponent_Template_button_click_15_listener() {\n        return ctx.changeQty(1);\n      });\n      i0.ɵɵtext(16, \"+\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"div\", 9);\n      i0.ɵɵtemplate(18, ProductPageComponent_button_18_Template, 2, 1, \"button\", 10);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(19, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function ProductPageComponent_Template_button_click_19_listener() {\n        return ctx.addToCart();\n      });\n      i0.ɵɵelementStart(20, \"span\");\n      i0.ɵɵtext(21, \"Add to cart\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"p\", 12);\n      i0.ɵɵtext(23, \"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusamus ad adipisci aliquid atque autem blanditiis consequuntur delectus eius explicabo impedit inventore ipsa, maiores molestiae, mollitia numquam optio perspiciatis, tempora ut.\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(24, \"div\", 13);\n      i0.ɵɵelement(25, \"img\", 14);\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(ctx.productInfo.name);\n      i0.ɵɵadvance(11);\n      i0.ɵɵtextInterpolate(ctx.cartItem.quantity);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.stocks);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"src\", ctx.productInfo.imageURL, i0.ɵɵsanitizeUrl);\n    }\n  },\n  dependencies: [i7.NgForOf],\n  styles: [\".product-page[_ngcontent-%COMP%] {\\n  display: flex;\\n  padding: 20px 30px;\\n  justify-content: space-around;\\n}\\n\\n.details-container[_ngcontent-%COMP%] {\\n  width: 60%;\\n  text-align: center;\\n}\\n\\n.product-name[_ngcontent-%COMP%] {\\n  text-transform: uppercase;\\n  padding: 20px 0;\\n  font-size: 40px;\\n}\\n\\n.product-price[_ngcontent-%COMP%] {\\n  font-size: 25px;\\n  color: red;\\n  padding: 30px 0;\\n}\\n\\n.horizontal-line[_ngcontent-%COMP%] {\\n  border-top: 2px solid black;\\n  width: 70%;\\n  margin: auto;\\n}\\n\\n.product-size[_ngcontent-%COMP%] {\\n  padding-top: 30px;\\n}\\n\\n.quantity-buttons[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: center;\\n}\\n\\n.product-buttons[_ngcontent-%COMP%] {\\n  padding: 27px 0;\\n}\\n\\n.size-buttons[_ngcontent-%COMP%] {\\n  color: yellow;\\n}\\n\\n.product-btn[_ngcontent-%COMP%]:link, .product-btn[_ngcontent-%COMP%]:visited {\\n  outline: none;\\n  text-decoration: none;\\n  padding: 10px 10px;\\n  background-color: white;\\n  border: solid 1.2px black;\\n  cursor: pointer;\\n}\\n\\n.product-btn[_ngcontent-%COMP%]:focus {\\n  background-color: white;\\n  color: black;\\n}\\n\\n.add-to-cart-btn[_ngcontent-%COMP%] {\\n  transform: skew(-15deg);\\n  font-size: 14px;\\n  text-transform: uppercase;\\n  letter-spacing: 2px;\\n  border: none;\\n  outline: none;\\n  background-color: #b50000;\\n  color: white;\\n  font-weight: 600;\\n  width: 80%;\\n  padding: 20px 20px;\\n  margin-top: 20px;\\n}\\n\\n.add-to-cart-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  display: inline-block;\\n  transform: skew(15deg);\\n}\\n\\n.add-to-cart-btn[_ngcontent-%COMP%]:active {\\n  background-color: #980000;\\n}\\n\\n.product-description[_ngcontent-%COMP%] {\\n  width: 85%;\\n  margin: auto;\\n  text-align: center;\\n  padding-top: 30px;\\n  font-size: 17px;\\n}\\n\\n.image-container[_ngcontent-%COMP%] {\\n  margin-top: 50px;\\n  flex: 0 0 45%;\\n}\\n\\n.product-image[_ngcontent-%COMP%] {\\n  display: table-cell;\\n  text-align: center;\\n  height: 100%;\\n  margin: auto;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2R1Y3QtcGFnZS5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxrQkFBQTtFQUNBLDZCQUFBO0FBQ0Y7O0FBQ0E7RUFDRSxVQUFBO0VBQ0Esa0JBQUE7QUFFRjs7QUFBQTtFQUNFLHlCQUFBO0VBQ0EsZUFBQTtFQUNBLGVBQUE7QUFHRjs7QUFEQTtFQUNFLGVBQUE7RUFDQSxVQUFBO0VBQ0EsZUFBQTtBQUlGOztBQUZBO0VBQ0UsMkJBQUE7RUFDQSxVQUFBO0VBQ0EsWUFBQTtBQUtGOztBQUhBO0VBQ0UsaUJBQUE7QUFNRjs7QUFKQTtFQUNFLGFBQUE7RUFDQSx1QkFBQTtBQU9GOztBQUxBO0VBQ0UsZUFBQTtBQVFGOztBQU5BO0VBQ0UsYUFBQTtBQVNGOztBQU5FO0VBRUUsYUFBQTtFQUNBLHFCQUFBO0VBQ0Esa0JBQUE7RUFDQSx1QkFBQTtFQUNBLHlCQUFBO0VBQ0EsZUFBQTtBQVFKOztBQUxFO0VBQ0UsdUJBQUE7RUFDQSxZQUFBO0FBT0o7O0FBTEE7RUFDRSx1QkFBQTtFQUNBLGVBQUE7RUFDQSx5QkFBQTtFQUNBLG1CQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSx5QkFBQTtFQUNBLFlBQUE7RUFDQSxnQkFBQTtFQUNBLFVBQUE7RUFDQSxrQkFBQTtFQUNBLGdCQUFBO0FBUUY7O0FBTkU7RUFDRSxxQkFBQTtFQUNBLHNCQUFBO0FBUUo7O0FBTkU7RUFDRSx5QkFBQTtBQVFKOztBQU5BO0VBQ0UsVUFBQTtFQUNBLFlBQUE7RUFDQSxrQkFBQTtFQUNBLGlCQUFBO0VBQ0EsZUFBQTtBQVNGOztBQVBBO0VBQ0UsZ0JBQUE7RUFDQSxhQUFBO0FBVUY7O0FBUkE7RUFDRSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7QUFXRiIsImZpbGUiOiJwcm9kdWN0LXBhZ2UuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIucHJvZHVjdC1wYWdlXHJcbiAgZGlzcGxheTogZmxleFxyXG4gIHBhZGRpbmc6IDIwcHggMzBweFxyXG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kXHJcblxyXG4uZGV0YWlscy1jb250YWluZXJcclxuICB3aWR0aDogNjAlXHJcbiAgdGV4dC1hbGlnbjogY2VudGVyXHJcblxyXG4ucHJvZHVjdC1uYW1lXHJcbiAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZVxyXG4gIHBhZGRpbmc6IDIwcHggMFxyXG4gIGZvbnQtc2l6ZTogNDBweFxyXG5cclxuLnByb2R1Y3QtcHJpY2VcclxuICBmb250LXNpemU6IDI1cHhcclxuICBjb2xvcjogcmVkXHJcbiAgcGFkZGluZzogMzBweCAwXHJcblxyXG4uaG9yaXpvbnRhbC1saW5lXHJcbiAgYm9yZGVyLXRvcDogMnB4IHNvbGlkIGJsYWNrXHJcbiAgd2lkdGg6IDcwJVxyXG4gIG1hcmdpbjogYXV0b1xyXG5cclxuLnByb2R1Y3Qtc2l6ZVxyXG4gIHBhZGRpbmctdG9wOiAzMHB4XHJcblxyXG4ucXVhbnRpdHktYnV0dG9uc1xyXG4gIGRpc3BsYXk6IGZsZXhcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlclxyXG5cclxuLnByb2R1Y3QtYnV0dG9uc1xyXG4gIHBhZGRpbmc6IDI3cHggMFxyXG5cclxuLnNpemUtYnV0dG9uc1xyXG4gIGNvbG9yOiB5ZWxsb3dcclxuXHJcbi5wcm9kdWN0LWJ0blxyXG4gICY6bGluayxcclxuICAmOnZpc2l0ZWRcclxuICAgIG91dGxpbmU6IG5vbmVcclxuICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZVxyXG4gICAgcGFkZGluZzogMTBweCAxMHB4XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZVxyXG4gICAgYm9yZGVyOiBzb2xpZCAxLjJweCBibGFja1xyXG4gICAgY3Vyc29yOiBwb2ludGVyXHJcblxyXG5cclxuICAmOmZvY3VzXHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZVxyXG4gICAgY29sb3I6IGJsYWNrXHJcblxyXG4uYWRkLXRvLWNhcnQtYnRuXHJcbiAgdHJhbnNmb3JtOiBza2V3KC0xNWRlZylcclxuICBmb250LXNpemU6IDE0cHhcclxuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlXHJcbiAgbGV0dGVyLXNwYWNpbmc6IDJweFxyXG4gIGJvcmRlcjogbm9uZVxyXG4gIG91dGxpbmU6IG5vbmVcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjYjUwMDAwXHJcbiAgY29sb3I6IHdoaXRlXHJcbiAgZm9udC13ZWlnaHQ6IDYwMFxyXG4gIHdpZHRoOiA4MCVcclxuICBwYWRkaW5nOiAyMHB4IDIwcHhcclxuICBtYXJnaW4tdG9wOiAyMHB4XHJcblxyXG4gIHNwYW5cclxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9ja1xyXG4gICAgdHJhbnNmb3JtOiBza2V3KDE1ZGVnKVxyXG5cclxuICAmOmFjdGl2ZVxyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzk4MDAwMFxyXG5cclxuLnByb2R1Y3QtZGVzY3JpcHRpb25cclxuICB3aWR0aDogODUlXHJcbiAgbWFyZ2luOiBhdXRvXHJcbiAgdGV4dC1hbGlnbjogY2VudGVyXHJcbiAgcGFkZGluZy10b3A6IDMwcHhcclxuICBmb250LXNpemU6IDE3cHhcclxuXHJcbi5pbWFnZS1jb250YWluZXJcclxuICBtYXJnaW4tdG9wOiA1MHB4XHJcbiAgZmxleDogMCAwIDQ1JVxyXG5cclxuLnByb2R1Y3QtaW1hZ2VcclxuICBkaXNwbGF5OiB0YWJsZS1jZWxsXHJcbiAgdGV4dC1hbGlnbjogY2VudGVyXHJcbiAgaGVpZ2h0OiAxMDAlXHJcbiAgbWFyZ2luOiBhdXRvXHJcblxyXG5cclxuXHJcblxyXG4iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["ProductInfo","CartItem","i0","ProductPageComponent","constructor","route","productService","stockService","cartService","tokenStorageService","guestCartService","ngOnInit","cartItem","quantity","Promise","all","getProductById","getAStock","productInfo","findStockByProduct","productId","subscribe","data","stocks","currentProductId","snapshot","paramMap","get","toPromise","then","undefined","addToCart","user","getUser","console","log","addToCartTwo","existingCartItem","cartItems","find","item","relatedSizeAndStock","stockId","push","selectSize","size","changeQty","value","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\shopping\\showcase\\product-page\\product-page.component.ts","C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\shopping\\showcase\\product-page\\product-page.component.html"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {ProductInfo} from \"../../../../common/shopping/product-info\";\nimport {ProductService} from \"../../../../services/product.service\";\nimport {ActivatedRoute} from \"@angular/router\";\nimport {CartItem} from \"../../../../common/shopping/cart-item\";\nimport {CartService} from \"../../../../services/shopping/cart/cart.service\";\nimport {Stock} from \"../../../../common/prod-details/stock\";\nimport {StockService} from \"../../../../services/prod-details/stock.service\";\nimport {UserService} from \"../../../../services/authentication/user.service\";\nimport {TokenStorageService} from \"../../../../services/authentication/token-storage.service\";\nimport {GuestCartService} from \"../../../../services/shopping/cart/guest-cart.service\";\n\n@Component({\n  selector: 'app-product-page',\n  templateUrl: './product-page.component.html',\n  styleUrls: ['./product-page.component.sass']\n})\nexport class ProductPageComponent implements OnInit {\n\n  productInfo: ProductInfo = new ProductInfo();\n  cartItem!: CartItem;\n  currentProductId: number = 0;\n  stocks!: Stock[];\n\n\n  constructor(private route: ActivatedRoute,\n              private productService: ProductService,\n              private stockService: StockService,\n              private cartService: CartService,\n              private tokenStorageService: TokenStorageService,\n              private guestCartService: GuestCartService) {\n  }\n\n  async ngOnInit() {\n    this.cartItem = new CartItem();\n    this.cartItem.quantity = 1;\n    // use Promise.all() to wait for both getProductById() and getAStock() to complete\n    await Promise.all([this.getProductById(), this.getAStock()]);\n  }\n\n  async getAStock() {\n    // wait for getProductById() to complete before accessing its data\n    await this.getProductById();\n\n    if(this.productInfo !== null) {\n      this.stockService.findStockByProduct(this.productInfo.productId).subscribe(data => {\n        this.stocks = data;\n      })\n    }\n  }\n\n  async getProductById() {\n    this.currentProductId = +this.route.snapshot.paramMap.get('prodId')!;\n\n    // set the productInfo value and wait for it to complete\n    await this.productService.getProductById(this.currentProductId).toPromise().then(\n      data => {\n        if(data != undefined)\n          this.productInfo = data;\n      }\n    );\n  }\n\n\n  addToCart() {\n    let user = this.tokenStorageService.getUser();\n    //TODO: Use this service in ProductPageComponent and CartPageComponent\n    //TODO: Check if enough in stock\n    this.cartItem.productInfo = this.productInfo;\n    if(this.tokenStorageService.getUser() == undefined) {\n      console.log('we in here biatch')\n      this.addToCartTwo(this.cartItem);\n    }\n    else {\n      this.cartService.addToCart(this.cartItem).subscribe()\n    }\n\n  }\n\n  addToCartTwo(cartItem: CartItem) {\n    const existingCartItem = this.guestCartService.cartItems.find(item =>\n      item.productInfo.productId === cartItem.productInfo.productId &&\n      item.relatedSizeAndStock.stockId === cartItem.relatedSizeAndStock.stockId\n    );\n\n    if (existingCartItem) {\n      existingCartItem.quantity += cartItem.quantity;\n    } else {\n      this.guestCartService.cartItems.push(cartItem);\n    }\n  }\n\n  selectSize(size: any) {\n    this.cartItem.relatedSizeAndStock = size;\n  }\n\n  changeQty(value: number) {\n    this.cartItem.quantity += value;\n  }\n}\n","<div class=\"product-page\">\n  <div class=\"details-container\">\n    <h1 class=\"product-name\">{{productInfo.name}}</h1>\n    <p class=\"product-price\">\n      200 €\n    </p>\n    <hr class=\"horizontal-line\">\n    <p class=\"product-size\">size</p>\n    <div class=\"product-buttons\">\n      <div class=\"quantity-buttons\">\n        <button class=\"round-button\" (click)=\"changeQty(-1)\">-</button>\n        <p>{{cartItem.quantity}}</p>\n        <button class=\"round-button\" (click)=\"changeQty(1)\">+</button>\n      </div>\n      <div class=\"size-buttons\">\n        <button *ngFor=\"let size of stocks\" (click)=\"selectSize(size)\" class=\"product-btn\">{{size.size}}</button>\n      </div>\n\n    </div>\n    <button class=\"add-to-cart-btn\" (click)=\"addToCart()\"><span>Add to cart</span></button>\n    <p class=\"product-description\">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusamus ad adipisci\n      aliquid atque autem blanditiis consequuntur delectus eius explicabo impedit inventore ipsa, maiores molestiae,\n      mollitia numquam optio perspiciatis, tempora ut.</p>\n  </div>\n  <div class=\"image-container\">\n    <img [src]=\"productInfo.imageURL\" class=\"product-image\">\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module"}