{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/mouji/IdeaProjects/Fitness-store-2022/angular-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { OrderInfo } from \"../../../common/shopping/orderInfo\";\nimport { Cart } from \"../../../common/shopping/cart\";\nimport { ShippingAddress } from \"../../../common/users/shipping-address\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/shopping/order/order.service\";\nimport * as i2 from \"../../../services/shopping/cart/cart.service\";\nimport * as i3 from \"../../../services/authentication/token-storage.service\";\nimport * as i4 from \"../../../services/shopping/payment-method/payment-method.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\n\nfunction CheckoutPageComponent_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"span\", 18);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const cartItem_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cartItem_r3.productInfo.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(cartItem_r3.quantity);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cartItem_r3.totalPrice);\n  }\n}\n\nfunction CheckoutPageComponent_option_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const paymentMethod_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", paymentMethod_r4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(paymentMethod_r4.name);\n  }\n}\n\nexport class CheckoutPageComponent {\n  constructor(orderService, cartService, tokenStorageService, paymentMethodService) {\n    this.orderService = orderService;\n    this.cartService = cartService;\n    this.tokenStorageService = tokenStorageService;\n    this.paymentMethodService = paymentMethodService;\n    this.cart = new Cart();\n    this.orderInfo = new OrderInfo();\n    this.cartItems = [];\n    this.paymentMethods = [];\n    this.shippingAddress = new ShippingAddress();\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      //TODO: Transfer this cause it's duplicated code\n      _this.retrievePaymentMethods();\n\n      yield Promise.all([_this.retrieveUserCart(), _this.retrieveCartItems()]);\n    })();\n  }\n\n  increaseQuantity(cartItem) {\n    console.log(cartItem);\n  }\n\n  retrieveCartItems() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this2.retrieveUserCart();\n\n      _this2.cartService.retrieveCartItems(_this2.cart.cartId).subscribe(data => {\n        _this2.cartItems = data;\n      }, error => {\n        console.log(error);\n      });\n    })();\n  }\n\n  retrieveUserCart() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this3.cartService.retrieveCart().toPromise().then(data => {\n        if (data != undefined) _this3.cart = data;\n      }, error => {\n        console.log(error);\n      });\n    })();\n  }\n\n  retrievePaymentMethods() {\n    this.paymentMethodService.getAllPaymentMethods().subscribe(data => {\n      this.paymentMethods = data;\n    }, error => {\n      console.log(error);\n    });\n  }\n\n  validateCheckout() {\n    this.orderService.processCheckout(this.orderInfo, this.cartItems, this.tokenStorageService.getUser().username).subscribe(data => {\n      console.log(data);\n    }, error => {\n      console.log(error);\n    });\n  }\n\n}\n\nCheckoutPageComponent.ɵfac = function CheckoutPageComponent_Factory(t) {\n  return new (t || CheckoutPageComponent)(i0.ɵɵdirectiveInject(i1.OrderService), i0.ɵɵdirectiveInject(i2.CartService), i0.ɵɵdirectiveInject(i3.TokenStorageService), i0.ɵɵdirectiveInject(i4.PaymentMethodService));\n};\n\nCheckoutPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CheckoutPageComponent,\n  selectors: [[\"app-checkout-page\"]],\n  decls: 39,\n  vars: 6,\n  consts: [[1, \"checkout-page\"], [1, \"cart-section\"], [1, \"cart-table\"], [4, \"ngFor\", \"ngForOf\"], [1, \"user-section\"], [1, \"user-form\", 3, \"ngSubmit\"], [\"checkoutForm\", \"\"], [1, \"form-group\"], [\"for\", \"street\"], [\"type\", \"text\", \"id\", \"street\", \"name\", \"street\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"city\"], [\"type\", \"text\", \"id\", \"city\", \"name\", \"city\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"country\"], [\"type\", \"text\", \"id\", \"country\", \"name\", \"country\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"paymentMethod\", \"id\", \"paymentMethod\", 3, \"ngModel\", \"ngModelChange\"], [\"selected\", \"\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 1, \"checkout-button\"], [1, \"quantity\"], [3, \"ngValue\"]],\n  template: function CheckoutPageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h1\");\n      i0.ɵɵtext(3, \"Validation de commande\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"table\", 2)(5, \"thead\")(6, \"tr\")(7, \"th\");\n      i0.ɵɵtext(8, \"Produit\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"th\");\n      i0.ɵɵtext(10, \"Quantit\\u00E9\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"th\");\n      i0.ɵɵtext(12, \"Prix total\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(13, \"tbody\");\n      i0.ɵɵtemplate(14, CheckoutPageComponent_tr_14_Template, 8, 3, \"tr\", 3);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(15, \"div\", 4)(16, \"h2\");\n      i0.ɵɵtext(17, \"Informations personnelles\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"form\", 5, 6);\n      i0.ɵɵlistener(\"ngSubmit\", function CheckoutPageComponent_Template_form_ngSubmit_18_listener() {\n        return ctx.validateCheckout();\n      });\n      i0.ɵɵelementStart(20, \"div\", 7)(21, \"label\", 8);\n      i0.ɵɵtext(22, \"Street :\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"input\", 9);\n      i0.ɵɵlistener(\"ngModelChange\", function CheckoutPageComponent_Template_input_ngModelChange_23_listener($event) {\n        return ctx.shippingAddress.streetAndNumber = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(24, \"div\", 7)(25, \"label\", 10);\n      i0.ɵɵtext(26, \"City:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"input\", 11);\n      i0.ɵɵlistener(\"ngModelChange\", function CheckoutPageComponent_Template_input_ngModelChange_27_listener($event) {\n        return ctx.shippingAddress.city = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(28, \"div\", 7)(29, \"label\", 12);\n      i0.ɵɵtext(30, \"Country:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(31, \"input\", 13);\n      i0.ɵɵlistener(\"ngModelChange\", function CheckoutPageComponent_Template_input_ngModelChange_31_listener($event) {\n        return ctx.shippingAddress.country = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(32, \"div\", 7)(33, \"select\", 14);\n      i0.ɵɵlistener(\"ngModelChange\", function CheckoutPageComponent_Template_select_ngModelChange_33_listener($event) {\n        return ctx.orderInfo.paymentMethod = $event;\n      });\n      i0.ɵɵelementStart(34, \"option\", 15);\n      i0.ɵɵtext(35, \"Select a payment method\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(36, CheckoutPageComponent_option_36_Template, 2, 2, \"option\", 16);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(37, \"button\", 17);\n      i0.ɵɵtext(38, \"Valider la commande\");\n      i0.ɵɵelementEnd()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngForOf\", ctx.cartItems);\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngModel\", ctx.shippingAddress.streetAndNumber);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.shippingAddress.city);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.shippingAddress.country);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngModel\", ctx.orderInfo.paymentMethod);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.paymentMethods);\n    }\n  },\n  dependencies: [i5.NgForOf, i6.ɵNgNoValidate, i6.NgSelectOption, i6.ɵNgSelectMultipleOption, i6.DefaultValueAccessor, i6.SelectControlValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.RequiredValidator, i6.NgModel, i6.NgForm],\n  styles: [\".checkout-page[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: flex-start;\\n  justify-content: space-between;\\n  background-color: #f5f5f5;\\n  padding: 20px;\\n}\\n\\n.cart-section[_ngcontent-%COMP%] {\\n  width: 30%;\\n  padding-right: 10px;\\n}\\n\\n.user-section[_ngcontent-%COMP%] {\\n  width: 50%;\\n  padding-left: 10px;\\n}\\n\\n.cart-table[_ngcontent-%COMP%] {\\n  width: 100%;\\n  border-collapse: collapse;\\n  margin-bottom: 20px;\\n}\\n\\n.cart-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\\n  background-color: #333;\\n  color: #fff;\\n  padding: 10px;\\n  text-align: left;\\n}\\n\\n.cart-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\\n  padding: 10px;\\n  border-bottom: 1px solid #ccc;\\n}\\n\\nh1[_ngcontent-%COMP%] {\\n  color: #333;\\n  font-size: 24px;\\n  margin-bottom: 20px;\\n}\\n\\nh2[_ngcontent-%COMP%] {\\n  color: #333;\\n  font-size: 20px;\\n  margin-bottom: 20px;\\n}\\n\\n.user-form[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.form-group[_ngcontent-%COMP%] {\\n  margin-bottom: 10px;\\n}\\n\\nlabel[_ngcontent-%COMP%] {\\n  font-weight: bold;\\n}\\n\\ninput[type=text][_ngcontent-%COMP%], input[type=email][_ngcontent-%COMP%], input[type=tel][_ngcontent-%COMP%] {\\n  width: 100%;\\n  padding: 8px 12px;\\n  border: 1px solid #ccc;\\n  border-radius: 4px;\\n  margin-top: 4px;\\n  font-size: 14px;\\n  box-sizing: border-box;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrb3V0LXBhZ2UuY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxhQUFBO0VBQ0EsdUJBQUE7RUFDQSw4QkFBQTtFQUNBLHlCQUFBO0VBQ0EsYUFBQTtBQUNGOztBQUNBO0VBQ0UsVUFBQTtFQUNBLG1CQUFBO0FBRUY7O0FBQUE7RUFDRSxVQUFBO0VBQ0Esa0JBQUE7QUFHRjs7QUFEQTtFQUNFLFdBQUE7RUFDQSx5QkFBQTtFQUNBLG1CQUFBO0FBSUY7O0FBRkE7RUFDRSxzQkFBQTtFQUNBLFdBQUE7RUFDQSxhQUFBO0VBQ0EsZ0JBQUE7QUFLRjs7QUFIQTtFQUNFLGFBQUE7RUFDQSw2QkFBQTtBQU1GOztBQUhBO0VBQ0UsV0FBQTtFQUNBLGVBQUE7RUFDQSxtQkFBQTtBQU1GOztBQUpBO0VBQ0UsV0FBQTtFQUNBLGVBQUE7RUFDQSxtQkFBQTtBQU9GOztBQUxBO0VBQ0UsYUFBQTtFQUNBLHNCQUFBO0FBUUY7O0FBTkE7RUFDRSxtQkFBQTtBQVNGOztBQVBBO0VBQ0UsaUJBQUE7QUFVRjs7QUFSQTs7O0VBR0UsV0FBQTtFQUNBLGlCQUFBO0VBQ0Esc0JBQUE7RUFDQSxrQkFBQTtFQUNBLGVBQUE7RUFDQSxlQUFBO0VBQ0Esc0JBQUE7QUFXRiIsImZpbGUiOiJjaGVja291dC1wYWdlLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiLmNoZWNrb3V0LXBhZ2VcclxuICBkaXNwbGF5OiBmbGV4XHJcbiAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnRcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW5cclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmNWY1XHJcbiAgcGFkZGluZzogMjBweFxyXG5cclxuLmNhcnQtc2VjdGlvblxyXG4gIHdpZHRoOiAzMCVcclxuICBwYWRkaW5nLXJpZ2h0OiAxMHB4XHJcblxyXG4udXNlci1zZWN0aW9uXHJcbiAgd2lkdGg6IDUwJVxyXG4gIHBhZGRpbmctbGVmdDogMTBweFxyXG5cclxuLmNhcnQtdGFibGVcclxuICB3aWR0aDogMTAwJVxyXG4gIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2VcclxuICBtYXJnaW4tYm90dG9tOiAyMHB4XHJcblxyXG4uY2FydC10YWJsZSB0aFxyXG4gIGJhY2tncm91bmQtY29sb3I6ICMzMzNcclxuICBjb2xvcjogI2ZmZlxyXG4gIHBhZGRpbmc6IDEwcHhcclxuICB0ZXh0LWFsaWduOiBsZWZ0XHJcblxyXG4uY2FydC10YWJsZSB0ZFxyXG4gIHBhZGRpbmc6IDEwcHhcclxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2NjY1xyXG5cclxuXHJcbmgxXHJcbiAgY29sb3I6ICMzMzNcclxuICBmb250LXNpemU6IDI0cHhcclxuICBtYXJnaW4tYm90dG9tOiAyMHB4XHJcblxyXG5oMlxyXG4gIGNvbG9yOiAjMzMzXHJcbiAgZm9udC1zaXplOiAyMHB4XHJcbiAgbWFyZ2luLWJvdHRvbTogMjBweFxyXG5cclxuLnVzZXItZm9ybVxyXG4gIGRpc3BsYXk6IGZsZXhcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uXHJcblxyXG4uZm9ybS1ncm91cFxyXG4gIG1hcmdpbi1ib3R0b206IDEwcHhcclxuXHJcbmxhYmVsXHJcbiAgZm9udC13ZWlnaHQ6IGJvbGRcclxuXHJcbmlucHV0W3R5cGU9XCJ0ZXh0XCJdLFxyXG5pbnB1dFt0eXBlPVwiZW1haWxcIl0sXHJcbmlucHV0W3R5cGU9XCJ0ZWxcIl1cclxuICB3aWR0aDogMTAwJVxyXG4gIHBhZGRpbmc6IDhweCAxMnB4XHJcbiAgYm9yZGVyOiAxcHggc29saWQgI2NjY1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweFxyXG4gIG1hcmdpbi10b3A6IDRweFxyXG4gIGZvbnQtc2l6ZTogMTRweFxyXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3hcclxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["OrderInfo","Cart","ShippingAddress","i0","CheckoutPageComponent","constructor","orderService","cartService","tokenStorageService","paymentMethodService","ngOnInit","retrievePaymentMethods","Promise","all","retrieveUserCart","retrieveCartItems","increaseQuantity","cartItem","console","log","cart","cartId","subscribe","data","cartItems","error","retrieveCart","toPromise","then","undefined","getAllPaymentMethods","paymentMethods","validateCheckout","processCheckout","orderInfo","getUser","username","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\shopping\\checkout-page\\checkout-page.component.ts","C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\shopping\\checkout-page\\checkout-page.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {CartItem} from \"../../../common/shopping/cart-item\";\nimport {OrderService} from \"../../../services/shopping/order/order.service\";\nimport {OrderInfo} from \"../../../common/shopping/orderInfo\";\nimport {CartService} from \"../../../services/shopping/cart/cart.service\";\nimport {TokenStorageService} from \"../../../services/authentication/token-storage.service\";\nimport {Cart} from \"../../../common/shopping/cart\";\nimport {PaymentMethod} from \"../../../common/shopping/payment-method\";\nimport {PaymentMethodService} from \"../../../services/shopping/payment-method/payment-method.service\";\nimport {ShippingAddress} from \"../../../common/users/shipping-address\";\n\n@Component({\n  selector: 'app-checkout-page',\n  templateUrl: './checkout-page.component.html',\n  styleUrls: ['./checkout-page.component.sass']\n})\nexport class CheckoutPageComponent implements OnInit {\n\n  cart: Cart = new Cart();\n  orderInfo: OrderInfo = new OrderInfo();\n  cartItems: CartItem[] = [];\n  paymentMethods: PaymentMethod[] = [];\n  shippingAddress: ShippingAddress = new ShippingAddress();\n  constructor(private orderService: OrderService,\n              private cartService: CartService,\n              private tokenStorageService: TokenStorageService,\n              private paymentMethodService: PaymentMethodService) { }\n\n  async ngOnInit() {\n    //TODO: Transfer this cause it's duplicated code\n    this.retrievePaymentMethods();\n    await Promise.all([this.retrieveUserCart(), this.retrieveCartItems()])\n\n  }\n\n  increaseQuantity(cartItem: CartItem) {\n    console.log(cartItem);\n  }\n\n  async retrieveCartItems(){\n    await this.retrieveUserCart();\n\n    this.cartService.retrieveCartItems(this.cart.cartId).subscribe(\n      data => {\n        this.cartItems = data;\n      },\n      error => {\n        console.log(error);\n      }\n    );\n  }\n\n  async retrieveUserCart() {\n    await this.cartService.retrieveCart().toPromise().then(\n      data => {\n        if(data != undefined)\n          this.cart = data;\n      },\n      error => {\n        console.log(error);\n      }\n    );\n  }\n\n  retrievePaymentMethods() {\n    this.paymentMethodService.getAllPaymentMethods().subscribe(\n      data => {\n        this.paymentMethods = data;\n      },\n      error => {\n        console.log(error);\n      }\n    )\n  }\n\n  validateCheckout() {\n    this.orderService.processCheckout(this.orderInfo, this.cartItems, this.tokenStorageService.getUser().username).subscribe(\n      data => {\n        console.log(data)\n      },\n      error => {\n        console.log(error);\n      }\n    )\n  }\n}\n","<div class=\"checkout-page\">\n  <div class=\"cart-section\">\n    <h1>Validation de commande</h1>\n    <table class=\"cart-table\">\n      <thead>\n      <tr>\n        <th>Produit</th>\n        <th>Quantité</th>\n        <th>Prix total</th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr *ngFor=\"let cartItem of cartItems\">\n        <td>{{cartItem.productInfo.name}}</td>\n        <td>\n          <span class=\"quantity\">{{cartItem.quantity}}</span>\n        </td>\n        <td>{{cartItem.totalPrice}}</td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <div class=\"user-section\">\n    <h2>Informations personnelles</h2>\n    <form #checkoutForm (ngSubmit)=\"validateCheckout()\" class=\"user-form\">\n      <div class=\"form-group\">\n        <label for=\"street\">Street :</label>\n        <input type=\"text\" id=\"street\" name=\"street\" [(ngModel)]=\"shippingAddress.streetAndNumber\" required>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"city\">City:</label>\n        <input type=\"text\" id=\"city\" name=\"city\" [(ngModel)]=\"shippingAddress.city\" required>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"country\">Country:</label>\n        <input type=\"text\" id=\"country\" name=\"country\" [(ngModel)]=\"shippingAddress.country\" required>\n      </div>\n      <div class=\"form-group\">\n        <select name=\"paymentMethod\" id=\"paymentMethod\" [(ngModel)]=\"orderInfo.paymentMethod\">\n          <option selected>Select a payment method</option>\n          <option *ngFor=\"let paymentMethod of paymentMethods\" [ngValue]=\"paymentMethod\">{{paymentMethod.name}}</option>\n        </select>\n      </div>\n      <button class=\"checkout-button\" type=\"submit\">Valider la commande</button>\n    </form>\n  </div>\n</div>\n\n\n"]},"metadata":{},"sourceType":"module"}