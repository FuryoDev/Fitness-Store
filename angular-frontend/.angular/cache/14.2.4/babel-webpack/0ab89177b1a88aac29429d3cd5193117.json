{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/mouji/IdeaProjects/Fitness-store-2022/angular-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Cart } from \"../../../../common/shopping/cart\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/shopping/cart/cart.service\";\nimport * as i2 from \"../../../../services/shopping/cart/guest-cart.service\";\nimport * as i3 from \"../../../../services/authentication/token-storage.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/router\";\n\nfunction CartPageComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"p\");\n    i0.ɵɵtext(2, \"Nothing in your cart\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction CartPageComponent_div_1_tr_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"div\", 8);\n    i0.ɵɵelement(3, \"img\", 9);\n    i0.ɵɵelementStart(4, \"div\", 10)(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"small\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"small\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(11, \"br\");\n    i0.ɵɵelementStart(12, \"a\", 11);\n    i0.ɵɵtext(13, \"Remove\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"td\")(17, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function CartPageComponent_div_1_tr_13_Template_button_click_17_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const i_r4 = restoredCtx.index;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.changeQty(-1, i_r4));\n    });\n    i0.ɵɵtext(18, \"-\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"span\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function CartPageComponent_div_1_tr_13_Template_button_click_21_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const i_r4 = restoredCtx.index;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.changeQty(1, i_r4));\n    });\n    i0.ɵɵtext(22, \"+\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", item_r3.productInfo.imageURL, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r3.productInfo.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Price: \", item_r3.productInfo.price, \" \\u20AC\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Size: \", item_r3.relatedSizeAndStock.size, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", item_r3.totalPrice, \" \\u20AC\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(item_r3.quantity);\n  }\n}\n\nconst _c0 = function () {\n  return [\"/checkout\"];\n};\n\nfunction CartPageComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"h1\");\n    i0.ɵɵtext(2, \"Your Shopping Cart\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 2)(4, \"table\", 3)(5, \"tr\")(6, \"th\")(7, \"p\");\n    i0.ɵɵtext(8, \"Product\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Total\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Quantity\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(13, CartPageComponent_div_1_tr_13_Template, 23, 6, \"tr\", 4);\n    i0.ɵɵelementStart(14, \"tr\", 5);\n    i0.ɵɵelement(15, \"td\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 6)(17, \"h2\");\n    i0.ɵɵtext(18, \"TOTAL: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"h3\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"h2\");\n    i0.ɵɵtext(22, \"Delivery fees\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"h3\");\n    i0.ɵɵtext(24, \"3.5\\u20AC\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"button\")(26, \"a\", 7);\n    i0.ɵɵtext(27, \"Checkout\");\n    i0.ɵɵelementEnd()()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.cartItems);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r1.cart.totalPrice, \" \\u20AC\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(3, _c0));\n  }\n}\n\nexport class CartPageComponent {\n  constructor(cartService, guestCartService, tokenStorageService // Modify with your TokenStorageService\n  ) {\n    this.cartService = cartService;\n    this.guestCartService = guestCartService;\n    this.tokenStorageService = tokenStorageService;\n    this.cart = new Cart();\n    this.cartItems = [];\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield Promise.all([_this.retrieveUserCart(), _this.retrieveCartItems()]);\n    })();\n  }\n\n  retrieveCartItems() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this2.retrieveUserCart();\n\n      if (_this2.tokenStorageService.getUser() === undefined) {\n        // Use GuestCartService\n        _this2.cartItems = _this2.guestCartService.retrieveCartItems();\n      } else {\n        // Use CartService\n        _this2.cartService.retrieveCartItems(_this2.cart.cartId).subscribe(data => {\n          _this2.cartItems = data;\n\n          _this2.updateCartTotal();\n        }, error => {\n          console.log(error);\n        });\n      }\n    })();\n  }\n\n  retrieveUserCart() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this3.tokenStorageService.getUser() === undefined) {\n        // Use GuestCartService\n        _this3.cart = _this3.guestCartService.retrieveCart();\n      } else {\n        // Use CartService\n        yield _this3.cartService.retrieveCart().toPromise().then(data => {\n          if (data != undefined) {\n            _this3.cart = data;\n          }\n        }, error => {\n          console.log(error);\n        });\n      }\n    })();\n  }\n\n  changeQty(value, index) {\n    const cartItem = this.cartItems[index];\n    const newValue = cartItem.quantity + value;\n\n    if (newValue >= 1 && newValue <= 10) {\n      cartItem.quantity = newValue;\n      cartItem.totalPrice = cartItem.quantity * cartItem.productInfo.price;\n      this.updateCartTotal();\n    } else if (newValue < 1) {\n      cartItem.quantity = 1;\n      cartItem.totalPrice = cartItem.quantity * cartItem.productInfo.price;\n      this.updateCartTotal();\n    } else if (newValue > 10) {\n      cartItem.quantity = 10;\n      cartItem.totalPrice = cartItem.quantity * cartItem.productInfo.price;\n      this.updateCartTotal();\n    }\n  }\n\n  removeFromCart(index) {\n    if (index >= 0 && index < this.cart.cartItems.length) {\n      this.cart.cartItems.splice(index, 1);\n    }\n\n    this.updateCartTotal();\n  }\n\n  updateCartTotal() {\n    this.cart.totalPrice = this.cartItems.reduce((total, cartItem) => total + cartItem.totalPrice, 0);\n  }\n\n}\n\nCartPageComponent.ɵfac = function CartPageComponent_Factory(t) {\n  return new (t || CartPageComponent)(i0.ɵɵdirectiveInject(i1.CartService), i0.ɵɵdirectiveInject(i2.GuestCartService), i0.ɵɵdirectiveInject(i3.TokenStorageService));\n};\n\nCartPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CartPageComponent,\n  selectors: [[\"app-cart-page\"]],\n  decls: 2,\n  vars: 2,\n  consts: [[\"class\", \"\", 4, \"ngIf\"], [1, \"\"], [1, \"cart-container\"], [1, \"cart-table\"], [4, \"ngFor\", \"ngForOf\"], [1, \"horizontal-line\"], [1, \"subtotal-details\"], [3, \"routerLink\"], [1, \"cart-prod-details\"], [\"alt\", \"\", 3, \"src\"], [1, \"cart-texts\"], [\"href\", \"\"], [1, \"quantity-button\", \"decrement-button\", 3, \"click\"], [1, \"quantity-button\", \"increment-button\", 3, \"click\"]],\n  template: function CartPageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, CartPageComponent_div_0_Template, 3, 0, \"div\", 0);\n      i0.ɵɵtemplate(1, CartPageComponent_div_1_Template, 28, 4, \"div\", 0);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.cartItems.length == 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.cartItems.length > 0);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i5.RouterLinkWithHref],\n  styles: [\".cart-container[_ngcontent-%COMP%] {\\n  margin: 80px auto;\\n}\\n\\n.cart-table[_ngcontent-%COMP%] {\\n  margin: 80px auto;\\n  width: 70%;\\n  border-collapse: collapse;\\n}\\n\\n.cart-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\\n  text-align: left;\\n  padding: 5px;\\n  color: white;\\n  background-color: black;\\n  font-weight: normal;\\n}\\n\\n.cart-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\\n  padding: 10px;\\n}\\n\\n.cart-prod-details[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-wrap: wrap;\\n}\\n\\n.cart-prod-details[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  width: 150px;\\n  height: 150px;\\n  margin-right: 10px;\\n}\\n\\n.cart-texts[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n}\\n\\n.total-price[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: flex-end;\\n}\\n\\n.total-price[_ngcontent-%COMP%]   table[_ngcontent-%COMP%] {\\n  border-top: 3px solid red;\\n  width: 100%;\\n  max-width: 350px;\\n}\\n\\n.total-price[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child {\\n  text-align: right;\\n}\\n\\n.total-price[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child {\\n  text-align: right;\\n}\\n\\n.subtotal-details[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: flex-end;\\n  width: 30%;\\n  right: 10px;\\n  position: absolute;\\n}\\n\\n.subtotal-details[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  width: 50%;\\n  margin: 10px 0;\\n}\\n\\n.subtotal-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  padding-top: 10px;\\n  text-decoration: underline;\\n}\\n\\n.subtotal-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n  padding-top: 10px;\\n}\\n\\n.horizontal-line[_ngcontent-%COMP%] {\\n  border-top: 2px solid black;\\n  width: 70%;\\n  margin: auto;\\n}\\n\\n.quantity-button[_ngcontent-%COMP%] {\\n  background-color: #27ae60;\\n  color: #fff;\\n  border: none;\\n  padding: 5px 10px;\\n  cursor: pointer;\\n  transition: background-color 0.3s ease;\\n}\\n\\n.quantity-button[_ngcontent-%COMP%]:hover {\\n  background-color: #219653;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcnQtcGFnZS5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGlCQUFBO0FBQ0Y7O0FBQ0E7RUFDRSxpQkFBQTtFQUNBLFVBQUE7RUFDQSx5QkFBQTtBQUVGOztBQUFFO0VBQ0UsZ0JBQUE7RUFDQSxZQUFBO0VBQ0EsWUFBQTtFQUNBLHVCQUFBO0VBQ0EsbUJBQUE7QUFFSjs7QUFDRTtFQUNFLGFBQUE7QUFDSjs7QUFDQTtFQUNFLGFBQUE7RUFDQSxlQUFBO0FBRUY7O0FBQUU7RUFDRSxZQUFBO0VBQ0EsYUFBQTtFQUNBLGtCQUFBO0FBRUo7O0FBQUE7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSx1QkFBQTtBQUdGOztBQURBO0VBQ0UsYUFBQTtFQUNBLHlCQUFBO0FBSUY7O0FBSEU7RUFDRSx5QkFBQTtFQUNBLFdBQUE7RUFDQSxnQkFBQTtBQUtKOztBQUpJO0VBQ0UsaUJBQUE7QUFNTjs7QUFMSTtFQUNFLGlCQUFBO0FBT047O0FBTEE7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSx5QkFBQTtFQUNBLFVBQUE7RUFDQSxXQUFBO0VBQ0Esa0JBQUE7QUFRRjs7QUFORTtFQUNFLFVBQUE7RUFDQSxjQUFBO0FBUUo7O0FBTkU7RUFDRSxpQkFBQTtFQUNBLDBCQUFBO0FBUUo7O0FBTkU7RUFDRSxpQkFBQTtBQVFKOztBQU5BO0VBQ0UsMkJBQUE7RUFDQSxVQUFBO0VBQ0EsWUFBQTtBQVNGOztBQVBBO0VBQ0UseUJBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtFQUNBLGlCQUFBO0VBQ0EsZUFBQTtFQUNBLHNDQUFBO0FBVUY7O0FBUkE7RUFDRSx5QkFBQTtBQVdGIiwiZmlsZSI6ImNhcnQtcGFnZS5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIi5jYXJ0LWNvbnRhaW5lclxyXG4gIG1hcmdpbjogODBweCBhdXRvXHJcblxyXG4uY2FydC10YWJsZVxyXG4gIG1hcmdpbjogODBweCBhdXRvXHJcbiAgd2lkdGg6IDcwJVxyXG4gIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2VcclxuXHJcbiAgdGhcclxuICAgIHRleHQtYWxpZ246IGxlZnRcclxuICAgIHBhZGRpbmc6IDVweFxyXG4gICAgY29sb3I6IHdoaXRlXHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFja1xyXG4gICAgZm9udC13ZWlnaHQ6IG5vcm1hbFxyXG5cclxuXHJcbiAgdGRcclxuICAgIHBhZGRpbmc6IDEwcHhcclxuXHJcbi5jYXJ0LXByb2QtZGV0YWlsc1xyXG4gIGRpc3BsYXk6IGZsZXhcclxuICBmbGV4LXdyYXA6IHdyYXBcclxuXHJcbiAgaW1nXHJcbiAgICB3aWR0aDogMTUwcHhcclxuICAgIGhlaWdodDogMTUwcHhcclxuICAgIG1hcmdpbi1yaWdodDogMTBweFxyXG5cclxuLmNhcnQtdGV4dHNcclxuICBkaXNwbGF5OiBmbGV4XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtblxyXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyXHJcblxyXG4udG90YWwtcHJpY2VcclxuICBkaXNwbGF5OiBmbGV4XHJcbiAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZFxyXG4gIHRhYmxlXHJcbiAgICBib3JkZXItdG9wOiAzcHggc29saWQgcmVkXHJcbiAgICB3aWR0aDogMTAwJVxyXG4gICAgbWF4LXdpZHRoOiAzNTBweFxyXG4gICAgdGQ6bGFzdC1jaGlsZFxyXG4gICAgICB0ZXh0LWFsaWduOiByaWdodFxyXG4gICAgdGg6bGFzdC1jaGlsZFxyXG4gICAgICB0ZXh0LWFsaWduOiByaWdodFxyXG5cclxuLnN1YnRvdGFsLWRldGFpbHNcclxuICBkaXNwbGF5OiBmbGV4XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtblxyXG4gIGp1c3RpZnktY29udGVudDogZmxleC1lbmRcclxuICB3aWR0aDogMzAlXHJcbiAgcmlnaHQ6IDEwcHhcclxuICBwb3NpdGlvbjogYWJzb2x1dGVcclxuXHJcbiAgYnV0dG9uXHJcbiAgICB3aWR0aDogNTAlXHJcbiAgICBtYXJnaW46IDEwcHggMFxyXG5cclxuICBoMlxyXG4gICAgcGFkZGluZy10b3A6IDEwcHhcclxuICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lXHJcblxyXG4gIGgzXHJcbiAgICBwYWRkaW5nLXRvcDogMTBweFxyXG5cclxuLmhvcml6b250YWwtbGluZVxyXG4gIGJvcmRlci10b3A6IDJweCBzb2xpZCBibGFja1xyXG4gIHdpZHRoOiA3MCVcclxuICBtYXJnaW46IGF1dG9cclxuXHJcbi5xdWFudGl0eS1idXR0b25cclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjdhZTYwXHJcbiAgY29sb3I6ICNmZmZcclxuICBib3JkZXI6IG5vbmVcclxuICBwYWRkaW5nOiA1cHggMTBweFxyXG4gIGN1cnNvcjogcG9pbnRlclxyXG4gIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4zcyBlYXNlXHJcblxyXG4ucXVhbnRpdHktYnV0dG9uOmhvdmVyXHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzIxOTY1M1xyXG5cclxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["Cart","i0","i_r4","CartPageComponent","constructor","cartService","guestCartService","tokenStorageService","ngOnInit","Promise","all","retrieveUserCart","retrieveCartItems","getUser","undefined","cartItems","cart","cartId","subscribe","data","updateCartTotal","error","console","log","retrieveCart","toPromise","then","changeQty","value","index","cartItem","newValue","quantity","totalPrice","productInfo","price","removeFromCart","length","splice","reduce","total","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\shopping\\cart\\cart-page\\cart-page.component.ts","C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\shopping\\cart\\cart-page\\cart-page.component.html"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {Cart} from \"../../../../common/shopping/cart\";\nimport {CartService} from \"../../../../services/shopping/cart/cart.service\";\nimport {CartItem} from \"../../../../common/shopping/cart-item\";\nimport {GuestCartService} from \"../../../../services/shopping/cart/guest-cart.service\";\nimport {TokenStorageService} from \"../../../../services/authentication/token-storage.service\";\n\n@Component({\n  selector: 'app-cart-page',\n  templateUrl: './cart-page.component.html',\n  styleUrls: ['./cart-page.component.sass']\n})\nexport class CartPageComponent implements OnInit {\n\n  cart: Cart = new Cart();\n  cartItems: CartItem[] = [];\n\n  constructor(\n    private cartService: CartService,\n    private guestCartService: GuestCartService,\n    private tokenStorageService: TokenStorageService // Modify with your TokenStorageService\n  ) {\n  }\n\n  async ngOnInit() {\n    await Promise.all([this.retrieveUserCart(), this.retrieveCartItems()]);\n  }\n\n  async retrieveCartItems() {\n    await this.retrieveUserCart();\n\n    if (this.tokenStorageService.getUser() === undefined) {\n      // Use GuestCartService\n      this.cartItems = this.guestCartService.retrieveCartItems();\n    } else {\n      // Use CartService\n      this.cartService.retrieveCartItems(this.cart.cartId).subscribe(\n        data => {\n          this.cartItems = data;\n          this.updateCartTotal();\n        },\n        error => {\n          console.log(error);\n        }\n      );\n    }\n  }\n\n  async retrieveUserCart() {\n    if (this.tokenStorageService.getUser() === undefined) {\n      // Use GuestCartService\n      this.cart = this.guestCartService.retrieveCart()\n    } else {\n      // Use CartService\n      await this.cartService.retrieveCart().toPromise().then(\n        data => {\n          if (data != undefined) {\n            this.cart = data;\n          }\n        },\n        error => {\n          console.log(error);\n        }\n      );\n    }\n  }\n\n  changeQty(value: number, index: number) {\n    const cartItem = this.cartItems[index];\n\n    const newValue = cartItem.quantity + value;\n\n    if (newValue >= 1 && newValue <= 10) {\n      cartItem.quantity = newValue;\n      cartItem.totalPrice = cartItem.quantity * cartItem.productInfo.price;\n      this.updateCartTotal();\n    } else if (newValue < 1) {\n      cartItem.quantity = 1;\n      cartItem.totalPrice = cartItem.quantity * cartItem.productInfo.price;\n      this.updateCartTotal();\n    } else if (newValue > 10) {\n      cartItem.quantity = 10;\n      cartItem.totalPrice = cartItem.quantity * cartItem.productInfo.price;\n      this.updateCartTotal();\n    }\n  }\n\n  removeFromCart(index: number) {\n    if (index >= 0 && index < this.cart.cartItems.length) {\n      this.cart.cartItems.splice(index, 1);\n    }\n    this.updateCartTotal();\n  }\n\n  updateCartTotal() {\n    this.cart.totalPrice = this.cartItems.reduce(\n      (total, cartItem) => total + cartItem.totalPrice,\n      0\n    );\n  }\n}\n","  <div class=\"\" *ngIf=\"cartItems.length == 0\">\n    <p>Nothing in your cart</p>\n  </div>\n  <div class=\"\" *ngIf=\"cartItems.length > 0\">\n    <h1>Your Shopping Cart</h1>\n    <div class=\"cart-container\">\n      <table class=\"cart-table\">\n        <tr>\n          <th>\n            <p>Product</p>\n          </th>\n          <th>Total</th>\n          <th>Quantity</th>\n        </tr>\n        <tr *ngFor=\"let item of cartItems; let i = index\">\n          <td>\n            <div class=\"cart-prod-details\">\n              <img [src]=\"item.productInfo.imageURL\" alt=\"\">\n              <div class=\"cart-texts\">\n                <p>{{item.productInfo.name}}</p>\n                <small>Price: {{item.productInfo.price}} €</small>\n                <small>Size: {{item.relatedSizeAndStock.size}}</small>\n                <br>\n                <a href=\"\">Remove</a>\n              </div>\n            </div>\n          </td>\n          <td>{{item.totalPrice}} €</td>\n          <td>\n            <button class=\"quantity-button decrement-button\" (click)=\"changeQty(-1, i)\">-</button>\n            <span>{{item.quantity}}</span>\n            <button class=\"quantity-button increment-button\" (click)=\"changeQty(1, i)\">+</button>\n          </td>\n        </tr>\n        <tr class=\"horizontal-line\">\n          <td></td>\n        </tr>\n        <div class=\"subtotal-details\">\n          <h2>TOTAL: </h2>\n          <h3>{{cart.totalPrice}} €</h3>\n          <h2>Delivery fees</h2>\n          <h3>3.5€</h3>\n          <button><a [routerLink]=\"['/checkout']\">Checkout</a></button>\n        </div>\n      </table>\n    </div>\n  </div>\n\n\n\n"]},"metadata":{},"sourceType":"module"}