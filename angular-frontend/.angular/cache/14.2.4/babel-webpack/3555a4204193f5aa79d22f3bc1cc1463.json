{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/mouji/IdeaProjects/Fitness-store-2022/angular-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { faUser } from \"@fortawesome/free-solid-svg-icons/faUser\";\nimport { faCartShopping } from \"@fortawesome/free-solid-svg-icons/faCartShopping\";\nimport { Cart } from \"../../../common/shopping/cart\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/prod-details/category/category.service\";\nimport * as i2 from \"../../../services/shared/header-shared.service\";\nimport * as i3 from \"../../../services/authentication/token-storage.service\";\nimport * as i4 from \"../../../services/shopping/cart/cart.service\";\nimport * as i5 from \"../../../services/shopping/cart/guest-cart.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@fortawesome/angular-fontawesome\";\nimport * as i8 from \"@angular/router\";\n\nconst _c0 = function (a1) {\n  return [\"products-showcase\", a1];\n};\n\nfunction HeaderComponent_a_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const category_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(2, _c0, category_r7.categoryId));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(category_r7.name);\n  }\n}\n\nconst _c1 = function () {\n  return [\"/admin-dashboard\"];\n};\n\nfunction HeaderComponent_a_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 2);\n    i0.ɵɵtext(1, \"Admin\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c1));\n  }\n}\n\nconst _c2 = function () {\n  return [\"/admin-discount\"];\n};\n\nfunction HeaderComponent_a_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 2);\n    i0.ɵɵtext(1, \"Admin Discounts\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c2));\n  }\n}\n\nconst _c3 = function () {\n  return [\"/admin-payment-method\"];\n};\n\nfunction HeaderComponent_a_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 2);\n    i0.ɵɵtext(1, \"Admin PayMeth\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c3));\n  }\n}\n\nfunction HeaderComponent_span_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r4.numberOfProductsInCart);\n  }\n}\n\nconst _c4 = function () {\n  return [\"/login-page\"];\n};\n\nfunction HeaderComponent_a_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 2);\n    i0.ɵɵtext(1, \"Login\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c4));\n  }\n}\n\nconst _c5 = function () {\n  return [\"/personal-page\"];\n};\n\nfunction HeaderComponent_a_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 2);\n    i0.ɵɵelement(1, \"fa-icon\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(2, _c5));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"icon\", ctx_r6.faUser);\n  }\n}\n\nconst _c6 = function () {\n  return [\"/home\"];\n};\n\nconst _c7 = function () {\n  return [\"/cart\"];\n};\n\nexport class HeaderComponent {\n  constructor(categoryService, headerService, tokenStorageService, cartService, guestCartService) {\n    this.categoryService = categoryService;\n    this.headerService = headerService;\n    this.tokenStorageService = tokenStorageService;\n    this.cartService = cartService;\n    this.guestCartService = guestCartService;\n    this.cart = new Cart();\n    this.cartItems = [];\n    this.isAdmin = false;\n    this.isLoggedIn = false;\n    this.faUser = faUser;\n    this.faCart = faCartShopping;\n    this.categories = [];\n    this.numberOfProductsInCart = 0;\n  }\n\n  ngOnInit() {\n    this.headerService.reloadHeader$.subscribe(() => {\n      this.loadHeaderData();\n    });\n    this.retrieveCart();\n  }\n\n  loadHeaderData() {\n    console.log('Header component reloaded.');\n    this.retrieveCategories();\n    this.isUserLoggedIn();\n    this.isUserAdmin();\n  }\n\n  retrieveCategories() {\n    this.categoryService.getAllCategories().subscribe(data => {\n      this.categories = data;\n    });\n  }\n\n  isUserLoggedIn() {\n    this.isLoggedIn = !!this.tokenStorageService.getToken();\n  }\n\n  isUserAdmin() {\n    let roles = this.tokenStorageService.getUser().roles;\n    this.isAdmin = !!roles.includes(\"ADMIN\");\n  }\n\n  retrieveCart() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this.tokenStorageService.getUser() === undefined) {\n        // Use GuestCartService\n        _this.cart = _this.guestCartService.retrieveCart();\n        console.log(\"Guest Cart service\");\n      } else {\n        // Use CartService\n        _this.cartService.retrieveCart().toPromise().then(data => {\n          if (data != undefined) {\n            _this.cart = data;\n            console.log(\"Real Cart service\");\n          }\n        }, error => {\n          console.log(error);\n        });\n      }\n    })();\n  }\n\n  retrieveCartItems() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this2.retrieveCart();\n\n      if (_this2.tokenStorageService.getUser() === undefined) {\n        // Use GuestCartService\n        _this2.cartItems = _this2.guestCartService.retrieveCartItems();\n      } else {\n        // Use CartService\n        _this2.cartService.retrieveCartItems(_this2.cart.cartId).subscribe(data => {\n          _this2.cartItems = data; // this.updateCartTotal();\n        }, error => {\n          console.log(error);\n        });\n      }\n    })();\n  }\n\n}\n\nHeaderComponent.ɵfac = function HeaderComponent_Factory(t) {\n  return new (t || HeaderComponent)(i0.ɵɵdirectiveInject(i1.CategoryService), i0.ɵɵdirectiveInject(i2.HeaderSharedService), i0.ɵɵdirectiveInject(i3.TokenStorageService), i0.ɵɵdirectiveInject(i4.CartService), i0.ɵɵdirectiveInject(i5.GuestCartService));\n};\n\nHeaderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HeaderComponent,\n  selectors: [[\"app-header\"]],\n  decls: 17,\n  vars: 12,\n  consts: [[1, \"header\"], [1, \"logo\"], [3, \"routerLink\"], [1, \"cat-links\"], [1, \"cat-links-container\"], [\"href\", \"\", 3, \"routerLink\", 4, \"ngFor\", \"ngForOf\"], [3, \"routerLink\", 4, \"ngIf\"], [1, \"user-links\"], [1, \"cart-icon\", 3, \"routerLink\"], [3, \"icon\"], [\"class\", \"cart-count\", 4, \"ngIf\"], [\"href\", \"\", 3, \"routerLink\"], [1, \"cart-count\"]],\n  template: function HeaderComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"a\", 2)(3, \"p\");\n      i0.ɵɵtext(4, \"Logoo\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(5, \"nav\", 3)(6, \"div\", 4);\n      i0.ɵɵtemplate(7, HeaderComponent_a_7_Template, 2, 4, \"a\", 5);\n      i0.ɵɵtemplate(8, HeaderComponent_a_8_Template, 2, 2, \"a\", 6);\n      i0.ɵɵtemplate(9, HeaderComponent_a_9_Template, 2, 2, \"a\", 6);\n      i0.ɵɵtemplate(10, HeaderComponent_a_10_Template, 2, 2, \"a\", 6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"div\", 7)(12, \"a\", 8);\n      i0.ɵɵelement(13, \"fa-icon\", 9);\n      i0.ɵɵtemplate(14, HeaderComponent_span_14_Template, 2, 1, \"span\", 10);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(15, HeaderComponent_a_15_Template, 2, 2, \"a\", 6);\n      i0.ɵɵtemplate(16, HeaderComponent_a_16_Template, 2, 3, \"a\", 6);\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(10, _c6));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.categories);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isAdmin);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isAdmin);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isAdmin);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(11, _c7));\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"icon\", ctx.faCart);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.cart.cartItems.length > 0 || null);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isLoggedIn);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isLoggedIn);\n    }\n  },\n  dependencies: [i6.NgForOf, i6.NgIf, i7.FaIconComponent, i8.RouterLinkWithHref],\n  styles: [\".header[_ngcontent-%COMP%] {\\n  height: 6rem;\\n  display: flex;\\n  align-items: center;\\n  background-color: black;\\n  color: white;\\n  text-decoration: none;\\n}\\n.header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\n  font-size: 20px;\\n  color: white;\\n  text-decoration: none;\\n  margin-right: 15px;\\n}\\n.logo[_ngcontent-%COMP%] {\\n  width: 20%;\\n  text-align: center;\\n  font-size: 30px;\\n}\\n.cat-links[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n.cat-links-container[_ngcontent-%COMP%] {\\n  float: right;\\n}\\n.user-links[_ngcontent-%COMP%] {\\n  display: flex;\\n  width: 10%;\\n}\\n.cart-icon[_ngcontent-%COMP%] {\\n  position: relative;\\n}\\n.cart-count[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: -15px;\\n  right: -15px;\\n  background-color: red;\\n  color: white;\\n  border-radius: 50%;\\n  padding: 0 5px;\\n  font-size: 0.8em;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhlYWRlci5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLFlBQUE7RUFDQSxxQkFBQTtBQUNGO0FBQUU7RUFDRSxlQUFBO0VBQ0EsWUFBQTtFQUNBLHFCQUFBO0VBQ0Esa0JBQUE7QUFFSjtBQUNBO0VBQ0UsVUFBQTtFQUNBLGtCQUFBO0VBQ0EsZUFBQTtBQUVGO0FBQ0E7RUFDRSxXQUFBO0FBRUY7QUFBQTtFQUNFLFlBQUE7QUFHRjtBQURBO0VBQ0UsYUFBQTtFQUNBLFVBQUE7QUFJRjtBQWFBO0VBQ0Usa0JBQUE7QUFWRjtBQWFBO0VBQ0Usa0JBQUE7RUFDQSxVQUFBO0VBQ0EsWUFBQTtFQUNBLHFCQUFBO0VBQ0EsWUFBQTtFQUNBLGtCQUFBO0VBQ0EsY0FBQTtFQUNBLGdCQUFBO0FBVkYiLCJmaWxlIjoiaGVhZGVyLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiLmhlYWRlclxyXG4gIGhlaWdodDogNnJlbVxyXG4gIGRpc3BsYXk6IGZsZXhcclxuICBhbGlnbi1pdGVtczogY2VudGVyXHJcbiAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2tcclxuICBjb2xvcjogd2hpdGVcclxuICB0ZXh0LWRlY29yYXRpb246IG5vbmVcclxuICBhXHJcbiAgICBmb250LXNpemU6IDIwcHhcclxuICAgIGNvbG9yOiB3aGl0ZVxyXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lXHJcbiAgICBtYXJnaW4tcmlnaHQ6IDE1cHhcclxuXHJcblxyXG4ubG9nb1xyXG4gIHdpZHRoOiAyMCVcclxuICB0ZXh0LWFsaWduOiBjZW50ZXJcclxuICBmb250LXNpemU6IDMwcHhcclxuXHJcblxyXG4uY2F0LWxpbmtzXHJcbiAgd2lkdGg6IDEwMCVcclxuXHJcbi5jYXQtbGlua3MtY29udGFpbmVyXHJcbiAgZmxvYXQ6IHJpZ2h0XHJcblxyXG4udXNlci1saW5rc1xyXG4gIGRpc3BsYXk6IGZsZXhcclxuICB3aWR0aDogMTAlXHJcblxyXG4vLypcclxuLy8gIGJhY2tncm91bmQtY29sb3I6IGJsYWNrXHJcbi8vICBjb2xvcjogd2hpdGVcclxuLy9cclxuLy9hXHJcbi8vICBjb2xvcjogd2hpdGVcclxuLy8gIHRleHQtZGVjb3JhdGlvbjogbm9uZVxyXG4vL1xyXG4vL2E6dmlzaXRlZFxyXG4vLyAgY29sb3I6IHdoaXRlXHJcbi8vXHJcbi8vLm5hdi1saW5rc1xyXG4vLyAgZGlzcGxheTogZmxleFxyXG4vLyAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuXHJcblxyXG4uY2FydC1pY29uXHJcbiAgcG9zaXRpb246IHJlbGF0aXZlXHJcblxyXG5cclxuLmNhcnQtY291bnRcclxuICBwb3NpdGlvbjogYWJzb2x1dGVcclxuICB0b3A6IC0xNXB4XHJcbiAgcmlnaHQ6IC0xNXB4XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogcmVkXHJcbiAgY29sb3I6IHdoaXRlXHJcbiAgYm9yZGVyLXJhZGl1czogNTAlXHJcbiAgcGFkZGluZzogMCA1cHhcclxuICBmb250LXNpemU6IDAuOGVtXHJcblxyXG5cclxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["faUser","faCartShopping","Cart","i0","HeaderComponent","constructor","categoryService","headerService","tokenStorageService","cartService","guestCartService","ngOnInit","reloadHeader$","subscribe","loadHeaderData","retrieveCart","console","log","retrieveCategories","isUserLoggedIn","isUserAdmin","getAllCategories","data","categories","isLoggedIn","getToken","roles","getUser","isAdmin","includes","undefined","cart","toPromise","then","error","retrieveCartItems","cartItems","cartId","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\navigation\\header\\header.component.ts","C:\\Users\\mouji\\IdeaProjects\\Fitness-store-2022\\angular-frontend\\src\\app\\components\\navigation\\header\\header.component.html"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {Category} from \"../../../common/prod-details/category\";\nimport {CategoryService} from \"../../../services/prod-details/category/category.service\";\nimport {faUser} from \"@fortawesome/free-solid-svg-icons/faUser\";\nimport {faCartShopping} from \"@fortawesome/free-solid-svg-icons/faCartShopping\";\nimport {TokenStorageService} from \"../../../services/authentication/token-storage.service\";\nimport {HeaderSharedService} from \"../../../services/shared/header-shared.service\";\nimport {Cart} from \"../../../common/shopping/cart\";\nimport {CartService} from \"../../../services/shopping/cart/cart.service\";\nimport {GuestCartService} from \"../../../services/shopping/cart/guest-cart.service\";\nimport {CartItem} from \"../../../common/shopping/cart-item\";\n\n@Component({\n  selector: 'app-header',\n  templateUrl: './header.component.html',\n  styleUrls: ['./header.component.sass']\n})\nexport class HeaderComponent implements OnInit {\n\n  cart: Cart = new Cart();\n  cartItems: CartItem[] = [];\n  isAdmin: boolean = false;\n  isLoggedIn: boolean = false;\n  faUser = faUser\n  faCart = faCartShopping\n  categories: Category[] = [];\n  numberOfProductsInCart: number = 0;\n\n  constructor(private categoryService: CategoryService,\n              private headerService: HeaderSharedService,\n              private tokenStorageService: TokenStorageService,\n              private cartService: CartService,\n              private guestCartService: GuestCartService) {\n  }\n\n  ngOnInit(): void {\n    this.headerService.reloadHeader$.subscribe(() => {\n      this.loadHeaderData();\n    });\n    this.retrieveCart();\n  }\n\n  loadHeaderData() {\n    console.log('Header component reloaded.');\n    this.retrieveCategories();\n    this.isUserLoggedIn();\n    this.isUserAdmin();\n  }\n\n  retrieveCategories() {\n    this.categoryService.getAllCategories().subscribe(\n      data => {\n        this.categories = data;\n      }\n    )\n  }\n\n  isUserLoggedIn() {\n    this.isLoggedIn = !!this.tokenStorageService.getToken();\n  }\n\n  isUserAdmin() {\n    let roles = this.tokenStorageService.getUser().roles;\n    this.isAdmin = !!roles.includes(\"ADMIN\");\n  }\n\n  async retrieveCart() {\n    if (this.tokenStorageService.getUser() === undefined) {\n      // Use GuestCartService\n      this.cart = this.guestCartService.retrieveCart()\n      console.log(\"Guest Cart service\")\n    } else {\n      // Use CartService\n      this.cartService.retrieveCart().toPromise().then(\n        data => {\n          if (data != undefined) {\n            this.cart = data;\n            console.log(\"Real Cart service\")\n          }\n        },\n        error => {\n          console.log(error);\n        }\n      );\n    }\n  }\n\n  async retrieveCartItems() {\n    await this.retrieveCart();\n\n    if (this.tokenStorageService.getUser() === undefined) {\n      // Use GuestCartService\n      this.cartItems = this.guestCartService.retrieveCartItems();\n    } else {\n      // Use CartService\n      this.cartService.retrieveCartItems(this.cart.cartId).subscribe(\n        data => {\n          this.cartItems = data;\n          // this.updateCartTotal();\n        },\n        error => {\n          console.log(error);\n        }\n      );\n    }\n  }\n}\n","<div class=\"header\">\n  <div class=\"logo\">\n    <a [routerLink]=\"['/home']\"><p>Logoo</p>\n    </a>\n  </div>\n  <nav class=\"cat-links\">\n    <div class=\"cat-links-container\">\n      <a [routerLink]=\"['products-showcase', category.categoryId]\" *ngFor=\"let category of categories\"\n         href=\"\">{{category.name}}</a>\n      <a *ngIf=\"isAdmin\" [routerLink]=\"['/admin-dashboard']\">Admin</a>\n      <a *ngIf=\"isAdmin\" [routerLink]=\"['/admin-discount']\">Admin Discounts</a>\n      <a *ngIf=\"isAdmin\" [routerLink]=\"['/admin-payment-method']\">Admin PayMeth</a>\n\n    </div>\n  </nav>\n  <div class=\"user-links\">\n    <a [routerLink]=\"['/cart']\" class=\"cart-icon\">\n      <fa-icon [icon]=\"faCart\"></fa-icon>\n      <span class=\"cart-count\" *ngIf=\"cart.cartItems.length > 0 || null\">{{numberOfProductsInCart}}</span>\n    </a>\n    <a *ngIf=\"!isLoggedIn\"[routerLink]=\"['/login-page']\">Login</a>\n    <a *ngIf=\"isLoggedIn\"[routerLink]=\"['/personal-page']\">\n      <fa-icon [icon]=\"faUser\"></fa-icon>\n    </a>\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module"}